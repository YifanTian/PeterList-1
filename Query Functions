USE PeterList;
CREATE FUNCTION searchPostingCategory(category) {
    (SELECT *
    FROM Postings p
    WHERE p.postingCategory = category
    )
};

USE PeterList;
searchPostingCategory("Job");
searchPostingCategory("Event");
searchPostingCategory("Item Sale");
searchPostingCategory("Housing Sale");
searchPostingCategory("Housing Lease");


USE PeterList;
CREATE FUNCTION searchJob(jobType,jobIndustry) {
(SELECT *
FROM Postings p
WHERE (p.postingCategory = "Job" AND (jobType IS NULL OR p.jobType = jobType) AND (jobIndustry IS NULL OR p. jobIndustry = jobIndustry ))
)
};

USE PeterList;
searchJob("Full Time","Management");

USE PeterList;
CREATE FUNCTION searchEvent(eventCategory,eventStartOn ){
(
SELECT *
FROM Postings p
WHERE(p.postingCategory = "Event" AND (eventCategory IS NULL OR p.eventCategory = eventCategory) AND (eventStartOn IS NULL OR p.eventStartOn >= eventStartOn))
)	
};

USE PeterList;
searchEvent("Travel","2017-06-01T00:00:00");


USE PeterList;
CREATE FUNCTION searchItemSale(itemCategory,condition,priceMin,priceMax){
(SELECT *
FROM Postings p
WHERE (p.postingCategory = "Item Sale" AND (itemCategory IS NULL OR p.itemCategory = itemCategory) AND (condition IS NULL OR p.condition = condition) AND (priceMin IS NULL OR p.postInfo.amount >= priceMin) AND (priceMax IS NULL OR p.postInfo.amount <= priceMax))
)	
};

**Works with Indexing**
USE PeterList;
searchItemSale("Musical Instruments","Good",NULL,NULL); 
**0.04 VS 0.039**


** Housing **
USE PeterList;
CREATE FUNCTION searchHousing(postingCategory){
(SELECT *
FROM Postings p
WHERE (postingCategory IS NULL OR p.postingCategory = postingCategory)
)
};

USE PeterList;
CREATE FUNCTION searchHousingSale(priceMin,priceMax,bedroomNumber,bathroomNumber,homeType,size,dateAvailable,furnished,parkingNumber){
(SELECT *
FROM Postings p
WHERE (p.postingCategory = "Housing Sale" AND (priceMin IS NULL OR p.postInfo.amount >= priceMin) AND (priceMax IS NULL OR p.postInfo.amount <= priceMax) AND (bedroomNumber IS NULL OR p.bedroomNumber = bedroomNumber) AND (bathroomNumber IS NULL OR p.bathroomNumber = bathroomNumber) AND (homeType IS NULL OR p.homeType = homeType) AND (size IS NULL OR p.size <= size) AND (dateAvailable IS NULL OR p.dateAvailable <= dateAvailable) AND (furnished IS NULL OR p.furnished = furnished) AND (parkingNumber IS NULL OR p.parkingNumber >= parkingNumber) )
)	
};

USE PeterList;
CREATE FUNCTION searchHousingLease(priceMin,priceMax,bedroomNumber,bathroomNumber,homeType,size,dateAvailable,furnished,hasParking,petAllowed,endDate,roommates){
(SELECT *
FROM Postings p
WHERE (p.postingCategory = "Housing Lease" AND (priceMin IS NULL OR p.postInfo.amount >= priceMin) AND (priceMax IS NULL OR p.postInfo.amount <= priceMax) AND (bedroomNumber IS NULL OR p.bedroomNumber = bedroomNumber) AND (bathroomNumber IS NULL OR p.bathroomNumber = bathroomNumber) AND (homeType IS NULL OR p.homeType = homeType) AND (size IS NULL OR p.size <= size) AND (dateAvailable IS NULL OR p.dateAvailable <= dateAvailable) AND (furnished IS NULL OR p.furnished = furnished) AND (hasParking IS NULL OR p.hasParking = hasParking) AND (petAllowed IS NULL OR p.petAllowed = petAllowed) AND (endDate IS NULL OR p.endDate <= endDate) AND (roommates IS NULL OR p.roommates <= roommates) )
)	
};
